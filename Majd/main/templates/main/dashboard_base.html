{% load static %}
{% load dashboard_nav %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{%block title%}{% endblock %}</title>
        <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Font Awesome v6 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.2/css/all.min.css">
    <!-- Google icons -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0&icon_names=check_circle" />
    <link rel="stylesheet" href="{% static 'css/dashboard_base.css' %}">


</head>
<body class="bg-light">

  <!-- Topbar -->
  <header class="navbar navbar-expand-lg sticky-top bg-white border-bottom shadow-sm-sm py-0">
    <div class="container-fluid">
      <!-- Left: brand -->
      <a class="navbar-brand d-flex align-items-center gap-2 py-2" href="#">
        <span class="rounded-circle bg-success text-white d-inline-flex align-items-center justify-content-center" style="width:28px;height:28px;">
          <i class="bi bi-lightning-charge"></i>
        </span>
        <span class="fw-semibold">MAJD</span>
      </a>

      <!-- Mobile: sidebar toggle -->
      <button class="btn btn-outline-success d-lg-none" data-bs-toggle="offcanvas" data-bs-target="#sidebarOffcanvas" aria-controls="sidebarOffcanvas" aria-label="Toggle navigation">
        <i class="bi bi-list"></i>
      </button>

      <!-- Right: user dropdown -->
      <div class="ms-auto d-flex align-items-center gap-3">
        {% if role_badge %}
          <span class="badge rounded-pill bg-success-subtle text-success-emphasis px-3 py-2">{{ role_badge }}</span>
        {% endif %}

        <div class="dropdown">
          <a class="d-flex align-items-center text-decoration-none" href="#" data-bs-toggle="dropdown" aria-expanded="false">
            <span class="me-2 text-muted d-none d-sm-inline">Hi, {{ request.user.first_name|default:request.user.username }}</span>
            <span class="rounded-circle bg-success text-white d-inline-flex align-items-center justify-content-center" style="width:34px;height:34px;">
              {{ request.user.first_name|default:request.user.username|slice:":1"|upper }}
            </span>
          </a>
          <ul class="dropdown-menu dropdown-menu-end shadow-sm">
            <li class="dropdown-header small">
              {{ request.user.get_full_name|default:request.user.username }}
              {% if role_badge %}<div class="text-muted">{{ role_badge }}</div>{% endif %}
            </li>
            <li><hr class="dropdown-divider"></li>
            <li><a class="dropdown-item" href="#"><i class="bi bi-gear me-2"></i>Account Settings</a></li>
            <li><a class="dropdown-item" href="#"><i class="bi bi-box-arrow-right me-2"></i>Sign Out</a></li>
          </ul>
        </div>
      </div>
    </div>
  </header>

  <div class="container-fluid">
    <div class="row">
<!-- Sidebar (desktop) -->
<nav class="col-lg-3 col-xl-2 d-none d-lg-block border-end bg-white min-vh-100 p-0">
  <div class="p-3">
    <!-- Profile summary -->
    <div class="d-flex align-items-center gap-3 mb-3">
      <span class="rounded-circle bg-success text-white d-inline-flex align-items-center justify-content-center flex-shrink-0"
            style="width:42px;height:42px;">
        {{ request.user.first_name|default:request.user.username|slice:":1"|upper }}
      </span>
      <div class="text-truncate">
        <div class="fw-semibold text-truncate">{{ request.user.get_full_name|default:request.user.username }}</div>
        {% if role_badge %}<div class="small text-muted text-truncate">{{ role_badge }}</div>{% endif %}
      </div>
    </div>

    <!-- Dynamic nav blocks -->
    {% block sidebar %}{% endblock %}


    <div class="mt-4 small">
      <a class="text-decoration-none text-muted d-inline-flex align-items-center gap-2" href="#">
        <i class="bi bi-house"></i> Back to Home
      </a>
    </div>
  </div>
</nav>


      <!-- Sidebar (mobile) -->
      <div class="offcanvas offcanvas-start" tabindex="-1" id="sidebarOffcanvas" aria-labelledby="sidebarOffcanvasLabel">
        <div class="offcanvas-header">
          <h5 class="offcanvas-title" id="sidebarOffcanvasLabel">Menu</h5>
          <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body p-0">
          <div class="list-group list-group-flush">
            {% for item in nav_items %}
              {% if item.header %}
                <div class="text-uppercase text-muted small mt-3 mb-2 px-3">{{ item.header }}</div>
              {% endif %}
              <a href="{{ item.url }}"
                 class="list-group-item list-group-item-action d-flex align-items-center gap-2 {% if request|is_active:item.url %}active{% endif %}"
                 data-bs-dismiss="offcanvas">
                {% if item.icon %}<i class="bi {{ item.icon }}"></i>{% endif %}
                <span class="flex-grow-1">{{ item.title }}</span>
                {% if item.badge %}<span class="badge text-bg-success">{{ item.badge }}</span>{% endif %}
              </a>
              {% if item.children %}
                {% for child in item.children %}
                  <a href="{{ child.url }}"
                     class="list-group-item list-group-item-action d-flex align-items-center gap-2 {% if request|is_active:child.url %}active{% endif %}"
                     data-bs-dismiss="offcanvas">
                    {% if child.icon %}<i class="bi {{ child.icon }}"></i>{% endif %}
                    <span class="flex-grow-1">{{ child.title }}</span>
                    {% if child.badge %}<span class="badge text-bg-success">{{ child.badge }}</span>{% endif %}
                  </a>
                {% endfor %}
              {% endif %}
            {% endfor %}
          </div>
        </div>
      </div>

      <!-- Main content -->
      <main class="col-lg-9 col-xl-10 p-3 p-md-4">
        {% block page_header %}
          <!-- Optional page header / breadcrumbs -->
        {% endblock %}

        {% block content %}
        {% endblock %}
      </main>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  {% block extra_js %}{% endblock %}
</body>
</html>