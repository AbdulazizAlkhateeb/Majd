{% extends "trainers/base_dashboard.html" %}
{% block title %}Conversation{% endblock %}
{% block messages %}{% endblock %}
{% block fileStyle %}
<style>
    textarea:focus {
    border-color: #198754 !important;   /* Bootstrap green */
    box-shadow: 0 0 0 0.25rem rgba(25, 135, 84, 0.25) !important;
}

    input:focus {
    border-color: #198754 !important;
    box-shadow: 0 0 0 0.25rem rgba(25, 135, 84, 0.25) !important;
}

</style>

{% endblock %}

{% block page_title %}Messages{% endblock %}
{% block content %}

<div class="container py-3">
    <div class="card shadow-sm border-0">
        <div class="card-header bg-white">
            <h5 class="mb-0"><i class="bi bi-chat-left-text text-success me-2"></i>
                Chat with {{ conversation.parent.user.get_full_name|default:conversation.parent.user.username }}
            </h5>
        </div>

        <div class="card-body px-4 py-3" style="background-color: #f9f9f9; max-height: 400px; overflow-y: auto;">
            {% for message in messages %}
                <div class="d-flex mb-3 {% if message.sender == user %}justify-content-end{% else %}justify-content-start{% endif %}">
                    <div class="rounded px-3 py-2 
                        {% if message.sender == user %}
                            bg-success text-white text-end
                        {% else %}
                            bg-white border border-1 shadow-sm
                        {% endif %}" style="max-width: 75%;">
                        <div>{{ message.body }}</div>
                        <div class="text-muted small mt-1">{{ message.sent_at|date:"M d, h:i A" }}</div>
                    </div>
                </div>
            {% empty %}
                <div class="text-muted text-center">No messages yet.</div>
            {% endfor %}
        </div>

        <div class="card-footer bg-white">
            <form method="POST" class="d-flex align-items-center">
                {% csrf_token %}
                <textarea name="body" class="form-control me-2" rows="1" placeholder="Type your message..." required></textarea>
                <button type="submit" class="btn btn-success"><i class="bi bi-send"></i> Send</button>
            </form>
        </div>
    </div>
    <!-- Back Link -->
    <div class="mt-3">
        <a href="{% url 'communication:trainer_conversations_view' %}" class="btn btn-outline-secondary btn-sm">
            <i class="bi bi-arrow-left"></i> Back to Messages
        </a>
    </div>
</div>

{% endblock %}
