{% extends "academies/base_dashboard.html" %}
{% load static %}

{% block content %}
<div class="container my-4">

  <!-- Django messages -->
  {% if messages %}
  <div class="mb-3">
    {% for message in messages %}
      <div class="alert {% if message.tags %}alert-{{ message.tags }}{% else %}alert-info{% endif %} alert-dismissible fade show" role="alert">
        {{ message }}
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>
    {% endfor %}
  </div>
  {% endif %}

  <div class="card border-0 shadow-sm">
    <div class="card-body">
      <div class="d-flex align-items-center justify-content-between flex-wrap gap-2 mb-3">
        <h5 class="mb-0">Pending Trainer Applications — {{ academy.name }}</h5>
        <span class="text-muted small">Only trainers who applied to this academy</span>
      </div>

      {% if pending_trainers %}
        <div class="table-responsive">
          <table class="table align-middle">
            <thead>
              <tr>
                <th>Trainer</th>
                <th>Specialty</th>
                <th>Experience</th>
                <th>Status</th>
                <th class="text-end">Actions</th>
              </tr>
            </thead>
            <tbody>
            {% for trainer in pending_trainers %}
              <tr>
                <td>{{ trainer.user.get_full_name|default:trainer.user.username }}</td>
                <td>{{ trainer.specialty|default:"—" }}</td>
                <td>{{ trainer.years_of_experience|default:"—" }}</td>
                <td><span class="badge text-bg-warning">{{ trainer.get_approval_status_display }}</span></td>
                <td class="text-end">
                  <!-- Approve -->
                  <form method="post" action="{% url 'academies:academy_pending_trainers_view' %}" class="d-inline">
                    {% csrf_token %}
                    <input type="hidden" name="trainer_id" value="{{ trainer.id }}">
                    <input type="hidden" name="action" value="approve">
                    <button class="btn btn-sm btn-success">Approve</button>
                  </form>
                  <!-- Reject -->
                  <form method="post" action="{% url 'academies:academy_pending_trainers_view' %}" class="d-inline ms-1">
                    {% csrf_token %}
                    <input type="hidden" name="trainer_id" value="{{ trainer.id }}">
                    <input type="hidden" name="action" value="reject">
                    <button class="btn btn-sm btn-outline-danger">Reject</button>
                  </form>
                </td>
              </tr>
            {% endfor %}
            </tbody>
          </table>
        </div>
      {% else %}
        <p class="text-muted mb-0">No pending trainer applications for this academy.</p>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}
